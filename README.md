# idea_code_release

# Проект

Данное веб‑приложение предназначено для упрощения процесса бронирования аудиторий в условиях высокой загруженности кабинетов МГУ. Система позволяет студентам и преподавателям оперативно находить свободные помещения и привлекать новые компетенции за счёт открытого исходного кода.

---

## 1. Регистрация и «баллы бронирования» (ББ)

- **Регистрация.** Каждый пользователь (студент или преподаватель) при первом входе в систему регистрируется и сразу получает **28 ББ** на личный счёт.  
- **Ежедневная очистка (03:00).** Система удаляет неактивные группы, возвращает их участникам вложенные ББ и удаляет группы без выигранных или мгновенных броней.  
- **Начисление ББ.** **Сразу после** ежедневной очистки (чтобы исключить любые махинации) и затем ежедневно в **08:00** всем пользователям начисляются **+4 ББ**. При превышении лимита в **28 ББ** излишек сгорает.

---

## 2. Слоты и стоимость брони

- **Список доступных слотов (45 минут каждый):**
  1. **Слот 1:** 09:00 – 09:45  
  2. **Слот 2:** 09:50 – 10:35  
  3. **Слот 3:** 10:50 – 11:35  
  4. **Слот 4:** 11:40 – 12:25  
  5. **Слот 5:** 13:30 – 14:15  
  6. **Слот 6:** 14:20 – 15:05  
  7. **Слот 7:** 15:20 – 16:05  
  8. **Слот 8:** 16:10 – 16:55  
  9. **Слот 9:** 17:05 – 17:50  
  10. **Слот 10:** 17:55 – 18:40  
  11. **Слот 11:** 18:55 – 19:40  
  12. **Слот 12:** 19:45 – 20:30  
  13. **Слот 13:** 20:45 – 21:30  
  14. **Слот 14:** 21:35 – 22:00

- **Стоимость.** За **каждый слот** пользователь платит **1 ББ**. Курс может динамически изменяться в зависимости от спроса.

---

## 3. Модель бронирования (аукцион)

1. **Целостность диапазона слотов.**  
   При заявке на диапазон слотов (например, слоты 1+2 = 09:00–10:35) нельзя забронировать или перебить лишь часть интервала. Перебить существующую заявку можно только предложив тот же или более длинный непрерывный диапазон (например, слоты 1–3).

2. **Время окончания аукциона.**  
   Аукцион закрывается за **1 час** до начала **первого** слота диапазона (для слотов 1–2 это 03:00).

3. **Продление («овертайм»).**  
   - Если в последние **3 минуты** до планового завершения (например, 07:57–08:00 для слота 1) поступает новая более высокая ставка, окончание аукциона откладывается на **время последней ставки + 3 мин**.  
   - Правило «3 минут» применяется к каждой последующей ставке (если новая ставка в 08:01, новая граница = 08:04).  
   - **Финальный дедлайн:** любой аукцион завершается не позднее, чем **за 20 мин** до первого слота (для слота 1 – не позже 08:40).

4. **Завершение без овертайма.**  
   Если последняя ставка сделана до начала овертайма (например, в 07:56) и новых перебивок нет, аукцион закрывается в изначальное время.

5. **«Последняя минута».**  
   Если за час до начала слота никто не подал заявку, его можно мгновенно забронировать за фиксированную минимальную цену в **1 ББ**. Такая бронь сразу подтверждается и не может быть перебита.

---

## 4. Совместное бронирование (группы)

1. **Типы брони:**  
   - **Индивидуальная:** один пользователь тратит собственные ББ.  
   - **Групповая:** админ создаёт группу, участники вносят ББ в общий банк, а бронь делается от имени группы.

2. **Финансы групп:**  
   - Вносить ББ в банк группы можно только при **отсутствии** активных ставок (`bidding`).  
   - При статусе `lost` — ББ возвращаются в банк группы (не списываются).  
   - При статусе `won` — ББ списываются из банка группы и вычитаются из вкладов участников.  
   - Участник может в любой момент **вывести** свободные (не зарезервированные) ББ.

3. **Ежедневная очистка (03:00):**  
   - Сохраняются только «живые» группы (с бронями `won` или `instant_booked`).  
   - Все остальные группы удаляются: их ББ возвращаются участникам, записи о взносах и сами группы — удаляются.  
   - **Сразу после** удаления каждому пользователю начисляются **+4 ББ** (но не более 28) для предотвращения манипуляций.

---

> **Примечание:** Приложение разрабатывается специально для МГУ с учётом расписания, форматов пар (слотов) и особенностей работы студенческих сообществ.

